
<div>

  <img src="../../../assets/img/spinner.gif" id="spinner" class="top-margin" *ngIf="!classResultsReady">

  <div class="top-margin">
    <span *ngIf="classResultsReady && !extendedInfo">
      <table mat-table [dataSource]="this.classResults" class="mat-elevation-z8 center-table">
        <ng-container matColumnDef="name">
          <th mat-header-cell *matHeaderCellDef class="columnWidth center-align">Alumno</th>
          <td mat-cell *matCellDef="let element"> {{element.studentName}} </td>
        </ng-container>

        <span *ngFor="let module of this.courseFormat">
          <ng-container matColumnDef="{{module.moduleName}}">
            <th mat-header-cell *matHeaderCellDef class="columnWidth center-align extended-info" (click)="showModuleExtendedInfo(module.id, module.moduleName)"> {{module.moduleName}} </th>
            <td mat-cell *matCellDef="let element">{{element.grades[this.courseFormat.indexOf(module)]}}</td>
          </ng-container>
        </span>

        <ng-container matColumnDef="studentAverage">
          <th mat-header-cell *matHeaderCellDef class="columnWidth center-align">Media</th>
          <td mat-cell *matCellDef="let element"> {{element.average}} </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="classColumnsToDisplay"></tr>
        <tr mat-row *matRowDef="let row; columns: classColumnsToDisplay;" class="columnWidth center-align"></tr>
      </table>
    </span>
  </div>

  <div class="top-margin">
    <span *ngIf="classResultsReady && extendedInfo">
      <span *ngIf="extendedInfo" class="extended-info" align="center" (click)="extendedInfo = false; extendedColumnsToDisplay=['name']">
        <mat-icon>keyboard_arrow_up</mat-icon>
      </span>
      <table mat-table [dataSource]="this.moduleExtendedResults" class="mat-elevation-z8 center-table">
        <ng-container matColumnDef="name">
          <th mat-header-cell *matHeaderCellDef class="columnWidth center-align">Alumno</th>
          <td mat-cell *matCellDef="let element"> {{element.studentName}} </td>
        </ng-container>

        <span *ngFor="let question of this.moduleFormat.questions">
          <ng-container matColumnDef="{{question}}">
            <th mat-header-cell *matHeaderCellDef class="columnWidth center-align"> {{question}} </th>
            <td mat-cell *matCellDef="let element">{{element.grades[this.moduleFormat.questions.indexOf(question)]}}</td>
          </ng-container>
        </span>

        <ng-container matColumnDef="studentAverage">
          <th mat-header-cell *matHeaderCellDef class="columnWidth center-align">Media</th>
          <td mat-cell *matCellDef="let element"> {{element.average}} </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="extendedColumnsToDisplay"></tr>
        <tr mat-row *matRowDef="let row; columns: extendedColumnsToDisplay;" class="columnWidth center-align"></tr>
      </table>
    </span>
  </div>

</div>
