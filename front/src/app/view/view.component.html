<!DOCTYPE HTML>
<html>
  <body>

    <div id="lateral-panel" [ngClass]="showMenu ? 'left-zero' : 'hidden-menu'">

      <div class="no-results" *ngIf="focusedUnitsService.focusedUnits.length <= 0">Ninguna unidad seleccionada</div>
      <div class="deselect-all-container" *ngIf="focusedUnitsService.focusedUnits.length > 1">
        <span class="deselect-all" (click)="confirmSelectUnit(null)">
          Desmarcar todas&nbsp;
          <mat-icon id="deselect-all-icon">close</mat-icon>
        </span>
      </div>
      <div class="focused-unit-list">
        <div class="result" *ngFor="let unit of focusedUnitsService.focusedUnits" (click)="confirmSelectUnit(unit)">
          <span class="unit-prefix">{{getUnitPrefix(unit.name)}}</span>
          <span class="unit-name">{{getUnitName(unit.name)}}</span>
          <mat-icon class="check-box">check_box</mat-icon>
        </div>
      </div>

      <hr>

      <mat-form-field appearance="outline" id="search">
        <mat-label>
          <mat-icon id="search-icon">search</mat-icon>
          <span id="search-label">&nbsp;Buscar unidad</span>
        </mat-label>
        <input id="search-input" matInput [(ngModel)]="searchField" (ngModelChange)="search()"/>
      </mat-form-field>

      <button mat-button class="new-unit-button" (click)="createSeparateUnit()">
        <mat-icon>add</mat-icon>Nueva unidad
      </button>

      <div class="result-list" *ngIf="results.length > 0">
        <span *ngFor="let result of results">
          <div class="result" (click)="confirmSelectUnit(result)" *ngIf="!focusedUnitsService.focusedUnitIds.has(result.id.toString())">
            <span class="unit-prefix">{{getUnitPrefix(result.name)}}</span>
            <span class="unit-name">{{getUnitName(result.name)}}</span>
            <mat-icon class="check-box">check_box_outline_blank</mat-icon>
          </div>
        </span>
      </div>
    </div>

    <mat-icon id="hide-menu-button" [ngClass]="showMenu ? 'show-hide-menu-button' : 'hidden-hide-menu-button'" (click)="setShowMenu(!showMenu)">reorder</mat-icon>

    <div id="top-panel">
      <span *ngIf="showDiagram">
        <mat-form-field [ngClass]="showMenu ? 'level-selector level-selector-with-menu' : 'level-selector'">
          <mat-label>Nivel padres</mat-label>
          <mat-select [value]="parentLevel">
            <mat-option *ngFor="let level of selectLevelOptions" [value]="level" (click)="reloadLevels(level, null)">
              <span *ngIf="level != -1">{{level}}</span>
              <span *ngIf="level == -1">Todos</span>
            </mat-option>
          </mat-select>
        </mat-form-field>
        <mat-form-field [ngClass]="showMenu ? 'level-selector level-selector-with-menu' : 'level-selector'">
          <mat-label>Nivel hijos</mat-label>
          <mat-select [value]="childrenLevel">
            <mat-option *ngFor="let level of selectLevelOptions" [value]="level" (click)="reloadLevels(null, level)">
              <span *ngIf="level != -1">{{level}}</span>
              <span *ngIf="level == -1">Todos</span>
            </mat-option>
          </mat-select>
        </mat-form-field>
      </span>
    </div>

    <button *ngIf="showDiagram" mat-button [ngClass]="ableToSave ? 'save-button save-button-enabled' : 'save-button'" (click)="save(null, null, null)">
      <mat-icon>save</mat-icon>
      Guardar
    </button>

    <div id="spinner-container" *ngIf="showSpinner">
      <img id="spinner" src="../../assets/img/spinner.gif">
      <span id="spinner-text">Cargando...</span>
      <div id="prevent-click"></div>
    </div>

    <span *ngIf="unitNameErrors" id="name-errors">
      Hay unidades con nombres repetidos
    </span>

    <div *ngIf="!showDiagram" id="tips">
      Busca una unidad para ver su diagrama
    </div>

    <div [hidden]="!showDiagram" [ngClass]="showMenu ? 'uml-content uml-content-with-menu' : 'uml-content uml-content-without-menu'" #uml></div>

    <div #umlNodeOptions (window:resize)="updateUmlNodeOptions()">
      <input id="uml-edit-input" (change)="updateUnitName()">
      <div id="uml-node-options">

        <!--<button id="inheritance-incoming-button" class="uml-options-button"><img src="../../assets/img/add-inheritance-incoming.png" height="15"></button>-->
        <button id="inheritance-outgoing-button" class="uml-options-button"><img src="../../assets/img/add-inheritance-outgoing.png" height="15"></button>
        <br>
        <!--<button id="composition-incoming-button" class="uml-options-button"><img src="../../assets/img/add-composition-incoming.png" height="15"></button>-->
        <button id="composition-outgoing-button" class="uml-options-button"><img src="../../assets/img/add-composition-outgoing.png" height="15"></button>
        <br>
        <!--<button id="aggregation-incoming-button" class="uml-options-button"><img src="../../assets/img/add-aggregation-incoming.png" height="15"></button>-->
        <button id="aggregation-outgoing-button" class="uml-options-button"><img src="../../assets/img/add-aggregation-outgoing.png" height="15"></button>
        <br>
        <!--<button id="association-incoming-button" class="uml-options-button"><img src="../../assets/img/add-association-incoming.png" height="15"></button>-->
        <button id="association-outgoing-button" class="uml-options-button"><img src="../../assets/img/add-association-outgoing.png" height="15"></button>
        <br>
        <!--<button id="use-incoming-button" class="uml-options-button"><img src="../../assets/img/add-use-incoming.png" height="15"></button>-->
        <!--<button id="use-outgoing-button" class="uml-options-button"><img src="../../assets/img/add-use-outgoing.png" height="15"></button>-->
        <!--<br>-->

        <button title="Eliminar unidad" class="delete-button uml-options-button" (click)="confirmDeleteUnit()">
          <mat-icon class="button-icon">delete</mat-icon>
        </button>

      </div>
    </div>

    <div #umlPathOptions (window:resize)="drawUmlPathOptions()" [hidden]="!showUmlPathOptions">
      <div id="uml-path-options">
        <div *ngIf="selectedRelationType!=='INHERITANCE'">
          <button id="inheritance-relation-button" class="uml-options-button uml-relation-button"><img src="../../assets/img/add-inheritance-outgoing.png" height="15"></button>
          <br>
        </div>
        <div *ngIf="selectedRelationType!=='COMPOSITION'">
          <button id="composition-relation-button" class="uml-options-button uml-relation-button"><img src="../../assets/img/add-composition-outgoing.png" height="15"></button>
          <br>
        </div>
        <div *ngIf="selectedRelationType!=='AGGREGATION'">
          <button id="aggregation-relation-button" class="uml-options-button uml-relation-button"><img src="../../assets/img/add-aggregation-outgoing.png" height="15"></button>
          <br>
        </div>
        <div *ngIf="selectedRelationType!=='ASSOCIATION'">
          <button id="association-relation-button" class="uml-options-button uml-relation-button"><img src="../../assets/img/add-association-outgoing.png" height="15"></button>
          <br>
        </div>
        <!--<div *ngIf="selectedRelationType!=='USE'">
          <button id="use-relation-button" class="uml-options-button uml-relation-button"><img src="../../assets/img/add-use-outgoing.png" height="15"></button>
        </div>-->

        <button title="Eliminar relaciÃ³n" class="delete-button uml-options-button" (click)="confirmDeleteRelation()">
          <mat-icon class="button-icon">delete</mat-icon>
        </button>

      </div>
    </div>

    <svg id="svg">
      <path #umlNewPath id="path"></path>
    </svg>

    <div id="notification-container">
      <mat-card class="notification" *ngIf="clickTutorialNotification">
        <mat-icon>live_help</mat-icon><br>
        <b>Doble click</b> para entrar<br>
        <b>Click derecho</b> para editar
        <mat-icon class="close-notification" (click)="closeClickTutorialNotification()">close</mat-icon><br>
      </mat-card>
      <mat-card class="notification" *ngIf="newUnitNotification">
        <mat-icon>live_help</mat-icon><br>
        Esa es una unidad nueva<br>
        <b>Guarda</b> para poder entrar
        <mat-icon class="close-notification" (click)="closeNewUnitNotification()">close</mat-icon><br>
      </mat-card>
    </div>

  </body>
</html>
