<!DOCTYPE HTML>
<html>
  <body>

    <div id="top-panel">

      <mat-form-field appearance="outline" id="search">
        <mat-label>
          <mat-icon id="search-icon">search</mat-icon>
          <span id="search-label">Buscar unidad</span>
        </mat-label>
        <input id="search-input" matInput [(ngModel)]="searchField" (ngModelChange)="search()" (keydown)="keyDown($event)"/>
        <div id="result-list" *ngIf="showResults">
          <div id="result" *ngFor="let result of results; let i = index" [class.active]="i==arrowKeyLocation" (mouseover)="setActive(i)">
            <span id="unit-prefix">{{getUnitPrefix(result.name)}}</span>
            <span id="unit-name">{{getUnitName(result.name)}}</span>
          </div>
        </div>
      </mat-form-field>

      <span *ngIf="loadedUnit">
        <mat-form-field class="level-selector">
          <mat-label>Nivel padres</mat-label>
          <mat-select [value]="parentLevel">
            <mat-option *ngFor="let level of selectLevelOptions" [value]="level" (click)="reloadLevels(level, null)">
              <span *ngIf="level != -1">{{level}}</span>
              <span *ngIf="level == -1">Todos</span>
            </mat-option>
          </mat-select>
        </mat-form-field>
        <mat-form-field class="level-selector">
          <mat-label>Nivel hijos</mat-label>
          <mat-select [value]="childrenLevel">
            <mat-option *ngFor="let level of selectLevelOptions" [value]="level" (click)="reloadLevels(null, level)">
              <span *ngIf="level != -1">{{level}}</span>
              <span *ngIf="level == -1">Todos</span>
            </mat-option>
          </mat-select>
        </mat-form-field>
      </span>

    </div>

    <div *ngIf="!loadedUnit" id="tips">
      Busca una unidad para ver su diagrama
    </div>

    <div id="json-editor-container" [hidden]="hideJson">
      <json-editor [options]="editorOptions" [(ngModel)]="data"></json-editor>
    </div>

    <button *ngIf="loadedUnit" mat-button [ngClass]="changed ? 'save-button save-button-enabled' : 'save-button'" (click)="save(null)">
      <mat-icon>save</mat-icon>
      Guardar
    </button>

    <div id="spinner-container" *ngIf="showSpinner">
      <img id="spinner" src="../../assets/img/spinner.gif">
      <span id="spinner-text">Cargando...</span>
    </div>

    <div class="uml-content" #uml></div>

    <div #umlNodeOptions (window:resize)="updateUmlNodeOptions()">
      <input id="uml-edit-input" (change)="updateUnitName()">
      <div id="uml-node-options">

        <button id="composition-incoming-button" class="uml-options-button"><img src="../../assets/img/add-composition-incoming.png" height="15"></button>
        <button id="composition-outgoing-button" class="uml-options-button"><img src="../../assets/img/add-composition-outgoing.png" height="15"></button>
        <br>
        <button id="inheritance-incoming-button" class="uml-options-button"><img src="../../assets/img/add-inheritance-incoming.png" height="15"></button>
        <button id="inheritance-outgoing-button" class="uml-options-button"><img src="../../assets/img/add-inheritance-outgoing.png" height="15"></button>
        <br>
        <button id="aggregation-incoming-button" class="uml-options-button"><img src="../../assets/img/add-aggregation-incoming.png" height="15"></button>
        <button id="aggregation-outgoing-button" class="uml-options-button"><img src="../../assets/img/add-aggregation-outgoing.png" height="15"></button>
        <br>
        <button id="association-incoming-button" class="uml-options-button"><img src="../../assets/img/add-association-incoming.png" height="15"></button>
        <button id="association-outgoing-button" class="uml-options-button"><img src="../../assets/img/add-association-outgoing.png" height="15"></button>
        <br>
        <button id="use-incoming-button" class="uml-options-button"><img src="../../assets/img/add-use-incoming.png" height="15"></button>
        <button id="use-outgoing-button" class="uml-options-button"><img src="../../assets/img/add-use-outgoing.png" height="15"></button>
        <br>

        <button title="Eliminar unidad" class="delete-button uml-options-button" (click)="deleteUnit()">
          <mat-icon class="button-icon">delete</mat-icon>
        </button>

      </div>
    </div>

    <div #umlPathOptions (window:resize)="drawUmlPathOptions()" [hidden]="!showUmlPathOptions">
      <div id="uml-path-options">
        <div *ngIf="selectedRelationType!=='COMPOSITION'">
          <button id="composition-relation-button" class="uml-options-button uml-relation-button"><img src="../../assets/img/add-composition-incoming.png" height="15"></button>
          <br>
        </div>
        <div *ngIf="selectedRelationType!=='INHERITANCE'">
          <button id="inheritance-relation-button" class="uml-options-button uml-relation-button"><img src="../../assets/img/add-inheritance-incoming.png" height="15"></button>
          <br>
        </div>
        <div *ngIf="selectedRelationType!=='AGGREGATION'">
          <button id="aggregation-relation-button" class="uml-options-button uml-relation-button"><img src="../../assets/img/add-aggregation-incoming.png" height="15"></button>
          <br>
        </div>
        <div *ngIf="selectedRelationType!=='ASSOCIATION'">
          <button id="association-relation-button" class="uml-options-button uml-relation-button"><img src="../../assets/img/add-association-incoming.png" height="15"></button>
          <br>
        </div>
        <div *ngIf="selectedRelationType!=='USE'">
          <button id="use-relation-button" class="uml-options-button uml-relation-button"><img src="../../assets/img/add-use-incoming.png" height="15"></button>
        </div>

        <button title="Eliminar relaciÃ³n" class="delete-button uml-options-button" (click)="deleteRelation()">
          <mat-icon class="button-icon">delete</mat-icon>
        </button>

      </div>
    </div>

    <svg id="svg">
      <path #umlNewPath id="path"></path>
    </svg>

  </body>
</html>
